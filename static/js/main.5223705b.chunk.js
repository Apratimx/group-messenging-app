(this["webpackJsonpmessenging-app"]=this["webpackJsonpmessenging-app"]||[]).push([[0],{71:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},83:function(e,t,c){},84:function(e,t,c){},85:function(e,t,c){},87:function(e,t,c){"use strict";c.r(t);var a=c(2),s=c.n(a),n=c(30),i=c.n(n),r=(c(71),c(18)),j=(c(72),c(105)),o=c(102),d=c(57),l=c.n(d),b=c(56),h=c.n(b),u=c(42),O=c.n(u),m=c(58),x=c.n(m),p=(c(73),c(59)),f=c.n(p),v=c(11),g=c(43),N=g.a.initializeApp({apiKey:"AIzaSyBgSKqJY9m0HeeO_Sz2EztU_aDTgS2Uws8",authDomain:"messenging-second.firebaseapp.com",projectId:"messenging-second",storageBucket:"messenging-second.appspot.com",messagingSenderId:"526290057292",appId:"1:526290057292:web:e8bbc7cfb0cb83b3e31ce9"}).firestore(),S=g.a.auth(),_=new g.a.auth.GoogleAuthProvider,y=N,C=c(4),w=Object(a.createContext)(),I=function(e){var t=e.reducer,c=e.initialState,s=e.children;return Object(C.jsx)(w.Provider,{value:Object(a.useReducer)(t,c),children:s})},R=function(){return Object(a.useContext)(w)};var E=function(){var e=Object(a.useState)(""),t=Object(r.a)(e,2),c=t[0],s=t[1],n=Object(v.f)().roomId,i=Object(a.useState)(""),d=Object(r.a)(i,2),b=d[0],u=d[1],m=Object(a.useState)([]),p=Object(r.a)(m,2),g=p[0],N=p[1],S=R(),_=Object(r.a)(S,2),w=_[0].user;return _[1],Object(a.useEffect)((function(){n&&(console.log("id foind"),y.collection("Rooms").doc(n).onSnapshot((function(e){return u(e.data().Name)})),y.collection("Rooms").doc(n).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return N(e.docs.map((function(e){return e.data()})))})))}),[n]),Object(C.jsxs)("div",{className:"chat",children:[Object(C.jsxs)("div",{className:"chat_header",children:[Object(C.jsx)(j.a,{}),Object(C.jsxs)("div",{className:"chat_headerinfo",children:[Object(C.jsx)("h3",{children:b}),Object(C.jsx)("p",{children:"last seen at ..."})]}),Object(C.jsxs)("div",{className:"chat_header_icons",children:[Object(C.jsx)(o.a,{children:Object(C.jsx)(h.a,{})}),Object(C.jsx)(o.a,{children:Object(C.jsx)(l.a,{})}),Object(C.jsx)(o.a,{children:Object(C.jsx)(O.a,{})})]})]}),Object(C.jsx)("div",{className:"chat_body",children:g.map((function(e){return Object(C.jsxs)("p",{className:"chat_message ".concat(e.name===w.displayName&&"chat_reciever"),children:[Object(C.jsx)("span",{className:"chat_name",children:e.name}),e.message,Object(C.jsx)("span",{className:"chat_timestamp",children:'"just now"'})]})}))}),Object(C.jsxs)("div",{className:"chat_footer",children:[Object(C.jsx)(x.a,{}),Object(C.jsxs)("form",{children:[Object(C.jsx)("input",{value:c,placeholder:"Type a message",onChange:function(e){return s(e.target.value)},type:"text"}),Object(C.jsx)("button",{onClick:function(e){e.preventDefault(),console.log("you typed >>>",c),y.collection("Rooms").doc(n).collection("messages").add({message:c,name:w.displayName,timestamp:(new Date).getTime()}),s("")},type:"submit",children:"Send a message"})]}),Object(C.jsx)(f.a,{})]})]})},T=c(103),k=c(61),A=c.n(k),B=c(60),D=c.n(B),P=c(34);c(83);var z=function(e){var t=e.id,c=e.name,s=e.addNewChat,n=Object(a.useState)(""),i=Object(r.a)(n,2),o=(i[0],i[1]);return Object(a.useEffect)((function(){o(Math.floor(5e3*Math.random()))}),[]),s?Object(C.jsx)("div",{onClick:function(){var e=prompt("please enter your name!");e&&y.collection("Rooms").add({Name:e})},className:"SidebarChat",children:Object(C.jsx)("h2",{children:"Add new chat!"})}):Object(C.jsx)(P.b,{to:"/rooms/".concat(t),children:Object(C.jsxs)("div",{className:"sidebarChat",children:[Object(C.jsx)(j.a,{src:"http://avatars.dicebear.com/api/human/".concat(t,".svg")}),Object(C.jsxs)("div",{className:"sidebarChat_info",children:[Object(C.jsx)("h2",{children:c}),Object(C.jsx)("p",{children:"This is the last message on the room"})]})]})})};c(84);var F=function(){var e=Object(a.useState)([]),t=Object(r.a)(e,2),c=t[0],s=t[1],n=R(),i=Object(r.a)(n,2),d=i[0].user;return i[1],Object(a.useEffect)((function(){y.collection("Rooms").onSnapshot((function(e){return s(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),Object(C.jsxs)("div",{className:"sidebar",children:[Object(C.jsxs)("div",{className:"sidebar_header",children:[Object(C.jsx)(j.a,{src:null===d||void 0===d?void 0:d.photoURL}),Object(C.jsxs)("div",{className:"sidebar_header_icons",children:[Object(C.jsx)(o.a,{children:Object(C.jsx)(D.a,{})}),Object(C.jsx)(o.a,{children:Object(C.jsx)(A.a,{})}),Object(C.jsx)(o.a,{children:Object(C.jsx)(O.a,{})})]})]}),Object(C.jsx)("div",{className:"sidebar_search",children:Object(C.jsxs)("div",{className:"sidebar_search_container",children:[Object(C.jsx)(T.a,{}),Object(C.jsx)("input",{placeholder:"Search or start new chat",type:"text"})]})}),Object(C.jsx)(z,{addNewChat:!0}),Object(C.jsx)("div",{className:"sidebar_chat",children:c.map((function(e){return Object(C.jsx)(z,{id:e.id,name:e.data.Name},e.id)}))})]})},U=c(62),J=c(104),L=(c(85),c(48)),M="SET_USER",G=function(e,t){switch(console.log(t),t.type){case M:return Object(L.a)(Object(L.a)({},e),{},{user:t.user});default:return e}};var K=function(){var e=R(),t=Object(r.a)(e,2);Object(U.a)(t[0]);var c=t[1];return Object(C.jsx)("div",{className:"login",children:Object(C.jsxs)("div",{className:"login_container",children:[Object(C.jsx)("div",{className:"login_text",children:Object(C.jsx)("h1",{children:"Sign in"})}),Object(C.jsx)(J.a,{onClick:function(){S.signInWithPopup(_).then((function(e){c({type:M,user:e.user})})).catch((function(e){return alert(e.message)}))},children:"Sign in with Google"})]})})};var q=function(){var e=R(),t=Object(r.a)(e,2),c=t[0].user;return t[1],Object(C.jsx)("div",{className:"App",children:c?Object(C.jsx)("div",{className:"app_body",children:Object(C.jsxs)(P.a,{children:[Object(C.jsx)(F,{}),Object(C.jsxs)(v.c,{children:[Object(C.jsx)(v.a,{path:"/rooms/:roomId",children:Object(C.jsx)(E,{})}),Object(C.jsx)(v.a,{path:"/",children:Object(C.jsx)(E,{})})]})]})}):Object(C.jsx)(K,{})})},H=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,106)).then((function(t){var c=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;c(e),a(e),s(e),n(e),i(e)}))};i.a.render(Object(C.jsx)(s.a.StrictMode,{children:Object(C.jsx)(I,{initialState:{user:null},reducer:G,children:Object(C.jsx)(q,{})})}),document.getElementById("root")),H()}},[[87,1,2]]]);
//# sourceMappingURL=main.5223705b.chunk.js.map